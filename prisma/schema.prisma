// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// ===============================================
// (FAD) Facebook Ads Data
// ===============================================

// Campaign Overview Report
model FAD_CampaignOverviewReport {
  pkId String @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now())

  // 1.Thông tin định danh
  id           String?
  name         String?
  objective    String?
  account_id   String?
  account_name String?

  // 2.Trạng thái & Thời gian
  status           String?
  effective_status String?
  start_time       DateTime?
  stop_time        DateTime?
  created_time     DateTime?
  updated_time     DateTime?

  // 3.Cấu hình Đấu thầu
  buying_type  String?
  bid_strategy String?

  // 4.Chỉ số Hiệu suất
  spend  Float?
  reach  Int?
  clicks Int?
  cpc    Float?
  cpm    Float?
  ctr    Float?

  // 5.Khoảng thời gian tải dữ liệu
  date_start DateTime?
  date_stop  DateTime?

  // 6.Chỉ số Hiệu suất & Chuyển đổi
  newMessagingConnections Int? // "New Messaging Connections"
  costPerNewMessaging     Float? // "Cost per New Messaging"
  leads                   Int? // "Leads"
  costLeads               Float? // "Cost Leads"
  purchases               Int? // "Purchases"
  costPurchases           Float? // "Cost Purchases"
  purchaseValue           Float? // "Purchase Value"
  purchaseROAS            Float? // "Purchase ROAS"
  websitePurchases        Int? // "Website Purchases"
  onFacebookPurchases     Int? // "On-Facebook Purchases"

  @@unique([user_id, account_id, id, date_start, date_stop])
  @@index([user_id])
  @@map("fad_campaign_overview_report")
}

// Campaign Performance by Age
model FAD_CampaignPerformanceByAge {
  pkId String @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now())

  // 1.Thông tin Chiến dịch
  campaign_id   String?
  campaign_name String? @db.Text()
  account_id    String?
  account_name  String? @db.Text()

  // 2.Phân loại (Breakdown)
  age String?

  // 3.Chỉ số Hiệu suất & Chuyển đổi
  spend                   Float?
  newMessagingConnections Int?
  costPerNewMessaging     Float?
  leads                   Int?
  costLeads               Float?
  purchases               Int?
  costPurchases           Float?
  purchaseValue           Float?
  purchaseROAS            Float?
  websitePurchases        Int?
  onFacebookPurchases     Int?

  // 4.Khoảng thời gian tải dữ liệu
  date_start DateTime?
  date_stop  DateTime?

  @@unique([user_id, account_id, date_start, date_stop, campaign_id, age])
  @@index([user_id])
  @@map("fad_campaign_performance_by_age")
}

// Campaign Performance by Gender
model FAD_CampaignPerformanceByGender {
  pkId String @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now())

  // 1.Thông tin Chiến dịch
  campaign_id   String?
  campaign_name String? @db.Text()
  account_id    String?
  account_name  String? @db.Text()

  // 2.Phân loại (Breakdown)
  gender String?

  // 3.Chỉ số Hiệu suất & Chuyển đổi
  spend                   Float?
  newMessagingConnections Int?
  costPerNewMessaging     Float?
  leads                   Int?
  costLeads               Float?
  purchases               Int?
  costPurchases           Float?
  purchaseValue           Float?
  purchaseROAS            Float?
  websitePurchases        Int?
  onFacebookPurchases     Int?

  // 4.Khoảng thời gian tải dữ liệu
  date_start DateTime?
  date_stop  DateTime?

  @@unique([user_id, account_id, date_start, date_stop, campaign_id, gender])
  @@index([user_id])
  @@map("fad_campaign_performance_by_gender")
}

// Campaign Performance by Platform
model FAD_CampaignPerformanceByPlatform {
  pkId String @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now())

  // 1.Thông tin Định danh
  account_id    String?
  account_name  String? @db.Text()
  campaign_id   String?
  campaign_name String? @db.Text()

  // 2.Phân loại (Breakdown)
  publisher_platform String?
  platform_position  String?

  // 3.Thời gian
  date_start DateTime?
  date_stop  DateTime?

  // 4.Chỉ số Hiệu suất
  spend       Float?
  impressions Int?
  clicks      Int?

  // 5.Chỉ số Chuyển đổi (Conversion)
  newMessagingConnections Int?
  costPerNewMessaging     Float?
  leads                   Int?
  costLeads               Float?
  purchases               Int?
  costPurchases           Float?
  purchaseValue           Float?
  purchaseROAS            Float?
  websitePurchases        Int?
  onFacebookPurchases     Int?

  @@unique([user_id, account_id, date_start, date_stop, campaign_id, publisher_platform, platform_position])
  @@index([user_id])
  @@map("fad_campaign_performance_by_platform")
}

// Campaign Performance by Region
model FAD_CampaignPerformanceByRegion {
  pkId String @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now())

  // 1.Thông tin Chiến dịch
  campaign_id   String?
  campaign_name String? @db.Text()
  account_id    String?
  account_name  String? @db.Text()

  // 2.Phân loại (Breakdown)
  region String?

  // 3.Chỉ số Hiệu suất
  spend       Float?
  impressions Int?
  clicks      Int?
  ctr         Float?

  // 4.Chỉ số Chuyển đổi (Conversion)
  newMessagingConnections Int?
  costPerNewMessaging     Float?
  leads                   Int?
  costLeads               Float?
  purchases               Int?
  costPurchases           Float?
  purchaseValue           Float?
  websitePurchases        Int?
  onFacebookPurchases     Int?

  // 5.Khoảng thời gian lấy dữ liệu
  date_start DateTime?
  date_stop  DateTime?

  @@unique([user_id, account_id, date_start, date_stop, campaign_id, region])
  @@index([user_id])
  @@map("fad_campaign_performance_by_region")
}

// Ad Set Performance Report
model FAD_AdSetPerformanceReport {
  pkId String @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now())

  // 1.Thông tin định danh
  id            String?
  name          String? @db.Text()
  campaign_id   String?
  campaign_name String? @db.Text()
  account_id    String?
  account_name  String? @db.Text()

  // 2.Trạng thái & Chẩn đoán
  status           String?
  effective_status String?
  created_time     DateTime?

  // 3.Ngân sách
  daily_budget    Float?
  lifetime_budget Float?
  budget_remaining Float?

  // 4.Chỉ số Hiệu suất
  spend       Float?
  impressions Int?
  reach       Int?
  clicks      Int?
  ctr         Float?
  cpc         Float?
  cpm         Float?

  // 5.Chỉ số Chuyển đổi (Conversion)
  newMessagingConnections Int?
  costPerNewMessaging     Float?
  leads                   Int?
  costLeads               Float?
  purchases               Int?
  costPurchases           Float?
  purchaseValue           Float?
  purchaseROAS            Float?
  websitePurchases        Int?
  onFacebookPurchases     Int?

  // Khoảng thời gian lấy dữ liệu
  date_start DateTime?
  date_stop  DateTime?

  @@unique([user_id, account_id, date_start, date_stop, campaign_id, id])
  @@index([user_id])
  @@map("fad_ad_set_performance_report")
}

// Ad Performance Report
model FAD_AdPerformanceReport {
  pkId String @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now())

  // 1.Thông tin định danh
  id            String?
  name          String? @db.Text()
  adset_id      String?
  adset_name    String? @db.Text()
  campaign_id   String?
  campaign_name String? @db.Text()
  account_id    String?
  account_name  String? @db.Text()
  created_time  DateTime?
  updated_time  DateTime?

  // 3.Trạng thái & Chẩn đoán
  status           String?
  effective_status String?

  // 4.Chỉ số Hiệu suất
  spend       Float?
  impressions Int?
  reach       Int?
  clicks      Int?
  ctr         Float?
  cpc         Float?
  cpm         Float?
  frequency   Float?

  // 5.Chỉ số Chuyển đổi (Conversion)
  newMessagingConnections Int?
  costPerNewMessaging     Float?
  leads                   Int?
  costLeads               Float?
  purchases               Int?
  costPurchases           Float?
  purchaseValue           Float?
  purchaseROAS            Float?
  websitePurchases        Int?
  onFacebookPurchases     Int?

  // 6.Khoảng thời gian lấy dữ liệu
  date_start DateTime?
  date_stop  DateTime?

  @@unique([user_id, account_id, date_start, date_stop, campaign_id, adset_id, id])
  @@index([user_id])
  @@map("fad_ad_performance_report")
}

// Account Daily Report
model FAD_AccountDailyReport {
  pkId String @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now())

  // 1.Thông tin định danh
  account_id       String?
  account_name     String? @db.Text()
  account_currency String?
  date_start       DateTime?
  date_stop        DateTime?

  // 2.Chỉ số Hiệu suất
  spend       Float?
  impressions Int?
  clicks      Int?
  cpc         Float?
  cpm         Float?
  ctr         Float?
  reach       Int?
  frequency   Float?

  // 3.Chỉ số Chuyển đổi (Conversion)
  newMessagingConnections Int?
  costPerNewMessaging     Float?
  leads                   Int?
  costLeads               Float?
  purchases               Int?
  costPurchases           Float?
  purchaseValue           Float?
  purchaseROAS            Float?
  websitePurchases        Int?
  onFacebookPurchases     Int?

  @@unique([user_id, account_id, date_start, date_stop])
  @@index([user_id])
  @@map("fad_account_daily_report")
}

// Campaign Daily Report
model FAD_CampaignDailyReport {
  pkId String @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now())

  // 1.Thông tin định danh
  campaign_id   String?
  campaign_name String? @db.Text()
  account_id    String?
  account_name  String? @db.Text()
  date_start    DateTime?
  date_stop     DateTime?

  // 2.Chỉ số Hiệu suất
  spend       Float?
  impressions Int?
  reach       Int?
  clicks      Int?
  cpc         Float?
  cpm         Float?
  ctr         Float?
  frequency   Float?

  // 3.Chỉ số Chuyển đổi (Conversion)
  newMessagingConnections Int?
  costPerNewMessaging     Float?
  leads                   Int?
  costLeads               Float?
  purchases               Int?
  costPurchases           Float?
  purchaseValue           Float?
  purchaseROAS            Float?
  websitePurchases        Int?
  onFacebookPurchases     Int?

  @@unique([user_id, account_id, campaign_id, date_start, date_stop])
  @@index([user_id])
  @@map("fad_campaign_daily_report")
}

// Ad Set Daily Report
model FAD_AdSetDailyReport {
  pkId String @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now())

  // Thông tin định danh
  id            String?
  name          String? @db.Text()
  campaign_id   String?
  campaign_name String? @db.Text()
  account_id    String?
  account_name  String? @db.Text()
  date_start    DateTime?
  date_stop     DateTime?

  // 2.Trạng thái & Chẩn đoán
  status           String?
  effective_status String?

  // 3.Ngân sách
  daily_budget    Float?
  lifetime_budget Float?
  budget_remaining Float?

  // 4.Chỉ số Hiệu suất
  spend       Float?
  impressions Int?
  reach       Int?
  clicks      Int?
  ctr         Float?
  cpc         Float?
  cpm         Float?
  frequency   Float?

  // 5.Chỉ số Chuyển đổi (Conversion)
  newMessagingConnections Int?
  costPerNewMessaging     Float?
  leads                   Int?
  costLeads               Float?
  purchases               Int?
  costPurchases           Float?
  purchaseValue           Float?
  purchaseROAS            Float?
  websitePurchases        Int?
  onFacebookPurchases     Int?

  @@unique([user_id, account_id, date_start, date_stop, campaign_id, id])
  @@index([user_id])
  @@map("fad_ad_set_daily_report")
}

// Ad Daily Report
model FAD_AdDailyReport {
  pkId String @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now())

  // 1.Thông tin định danh
  id            String?
  name          String? @db.Text()
  adset_id      String?
  adset_name    String? @db.Text()
  campaign_id   String?
  campaign_name String? @db.Text()
  account_id    String?
  account_name  String? @db.Text()
  date_start    DateTime?
  date_stop     DateTime?

  // 2.Trạng thái & Thời gian
  status           String?
  effective_status String?
  created_time     DateTime?

  // 3.Chỉ số Hiệu suất
  spend       Float?
  impressions Int?
  reach       Int?
  clicks      Int?
  ctr         Float?
  cpc         Float?
  cpm         Float?
  frequency   Float?

  // 4.Chỉ số Chuyển đổi (Conversion)
  newMessagingConnections Int?
  costPerNewMessaging     Float?
  leads                   Int?
  costLeads               Float?
  purchases               Int?
  costPurchases           Float?
  purchaseValue           Float?
  purchaseROAS            Float?
  websitePurchases        Int?
  onFacebookPurchases     Int?

  @@unique([user_id, account_id, date_start, date_stop, campaign_id, adset_id, id])
  @@index([user_id])
  @@map("fad_ad_daily_report")
}

// Ad Creative Report
model FAD_AdCreativeReport {
  pkId String @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now())

  // 1.Thông tin định danh
  id            String?
  name          String? @db.Text()
  adset_id      String?
  adset_name    String? @db.Text()
  campaign_id   String?
  campaign_name String? @db.Text()
  account_id    String?
  account_name  String? @db.Text()

  // 2.Trạng thái
  status           String?
  effective_status String?

  // 3.Thông tin Sáng tạo
  creative_id                String?
  actor_id                   String?
  page_name                  String? @db.Text()
  creative_title             String? @db.Text
  creative_body              String? @db.Text
  creative_thumbnail_url     String? @db.Text
  creative_thumbnail_raw_url String? @db.Text
  creative_link              String?

  // 4.Chỉ số Hiệu suất
  spend       Float?
  impressions Int?
  leads       Int?
  costLeads   Float?
  reach       Int?
  clicks      Int?
  ctr         Float?
  cpc         Float?
  cpm         Float?

  // 5.Chỉ số Chuyển đổi (Conversion)
  newMessagingConnections Int?
  costPerNewMessaging     Float?
  purchases               Int?
  purchaseValue           Float?
  purchaseROAS            Float?

  // 6.Khoảng thời gian lấy dữ liệu
  date_start DateTime?
  date_stop  DateTime?

  @@unique([user_id, account_id, date_start, date_stop, campaign_id, adset_id, id])
  @@index([user_id])
  @@map("fad_ad_creative_report")
}

// BM & Ad Accounts
model FAD_BmAndAdAccounts {
  pkId String @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now())

  // 1.Thông tin Business Manager
  bm_id                    String?
  bm_name                  String? @db.Text()
  bm_created_time          DateTime?
  bm_verification_status   String?
  bm_profile_picture_uri   String? @db.Text()

  // 2.Thông tin Tài khoản QC
  account_type             String?
  account_id               String?
  account_name             String? @db.Text()
  account_status_text      String?
  currency                 String?
  timezone_name            String? @db.Text()
  amount_spent             Float?
  balance                  Float?
  current_payment_method   String?
  tax_and_fee              Float?

  @@unique([user_id, bm_id, account_id])
  @@index([user_id])
  @@map("fad_bm_and_ad_accounts")
}

// ===============================================
// (FBT) FB Billing Tool
// ===============================================

// FB Billing Data
// Dựa trên các trường từ Google Sheet
model FBT_FbBillingData {
  pkId      String   @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now())

  // === Các trường từ Sheet ===
  accountId           String? // "act_65024989..."
  accountName         String?  @db.Text()// "Cara Luna 02"
  eventType           String? // "ad_account_bill"
  dateTimeInTimezone  String? // "10/20/2025 at 10:04 AM" (Lưu dạng String vì không phải ISO)
  fetchTimestamp      DateTime? // "2025-10-24 22:4..."
  currency            String? // "VND"
  
  // Lưu ý: Dùng Decimal cho tiền tệ để tránh lỗi làm tròn
  value               Decimal? // 53,102,500.00
  totalValue          Decimal? // 53,102,500.00
  tax                 Decimal? // (Từ cột 'Tax')

  // Dùng String cho ID để đảm bảo an toàn
  transactionId       String? // "2472147387087"
  action              String? // "67"
  type                String? // "payment_amour" (có thể là "payment_amount")
  
  // Dùng Float cho phần trăm
  taxAndFeePercent    Float? // "0%" (sẽ được lưu là 0)

  // Dùng @db.Text cho các link có thể rất dài
  billingHubLink      String? @db.Text
  downloadInvoiceLink String? @db.Text

  @@unique([user_id, accountId, transactionId])
  @@index([user_id])
  @@map("fbt_fb_billing_data")
}

// ===============================================
// (MPI) Meta Page Insight
// ===============================================

// BC Tương tác & Tăng trưởng Cộng đồng
model MPI_BcTuongTacTangTruongCongDong {
  pkId String @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now())

  // 1.Tương tác Trang
  page_daily_follows_unique   Int?
  page_daily_unfollows_unique Int?
  page_post_engagements       Int?

  // 2.Tăng trưởng Fan & Theo dõi
  page_fan_adds    Int?
  page_fan_removes Int?
  page_views_total Int?
  @@index(user_id)
  @@map("mpi_bc_tuong_tac_tang_truong_cong_dong")
}

// BC Hiển thị & Tiếp cận Trang
model MPI_BcHienThiTiepCanTrang {
  pkId String @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now())

  // 1.Hiển thị (Impressions)
  page_impressions     Int?
  page_impressions_paid Int?

  // 2.Tiếp cận (Reach)
  page_impressions_unique      Int?
  page_impressions_paid_unique Int?

  @@index([user_id])
  @@map("mpi_bc_hien_thi_tiep_can_trang")
}

// BC Hiệu suất Bài viết (Tổng hợp)
model MPI_BcHieuSuatBaiVietTongHop {
  pkId String @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now())

  // 1.Hiệu suất chính
  post_impressions        Int?
  post_impressions_unique Int?
  post_clicks             Int?

  // 2.Phân loại Hiển thị
  post_impressions_paid         Int?
  post_impressions_paid_unique  Int?
  post_impressions_organic      Int?
  post_impressions_organic_unique Int?

  // 3.Hiển thị theo Fan
  post_impressions_fan        Int?
  post_impressions_fan_unique Int?

  // 4.Phân loại theo tương tác
  post_reactions_like_total    Int?
  post_reactions_love_total    Int?
  post_reactions_wow_total     Int?
  post_reactions_haha_total    Int?
  post_reactions_sorry_total   Int?
  post_reactions_anger_total   Int?
  post_video_views             Int?
  post_activity_by_action_type Json?

  @@map("mpi_bc_hieu_suat_bai_viet_tong_hop")
}

// BC Phân tích Cảm xúc Bài viết
model MPI_BcPhanTichCamXucBaiViet {
  pkId String @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now())

  // 1.Các loại Reactions
  post_reactions_like_total  Int?
  post_reactions_love_total  Int?
  post_reactions_wow_total   Int?
  post_reactions_haha_total  Int?
  post_reactions_sorry_total Int?
  post_reactions_anger_total Int?

  @@index([user_id])
  @@map("mpi_bc_phan_tich_cam_xuc_bai_viet")
}

// BC Phân tích: Fan theo Vị trí
model MPI_BcPhanTichFanTheoViTri {
  pkId String @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now())

  // Metric
  page_fans_country Json?
  page_fans_city    Json?

  @@index([user_id])
  @@map("mpi_bc_phan_tich_fan_theo_vi_tri")
}

// BC Phân tích: Nguồn Lượt thích Mới
model MPI_BcPhanTichNguonLuotThichMoi {
  pkId String @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now())

  // Metric
  page_fan_adds_by_paid_non_paid_unique Json?
  
  @@index([user_id])
  @@map("mpi_bc_phan_tich_nguon_luot_thich_moi")
}

// BC Hiệu suất Video (Từng video)
model MPI_BcHieuSuatVideoTungVideo {
  pkId String @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now())

  // 3. Tiếp cận & Lượt xem Video
  post_impressions_unique    Int?
  post_video_retention_graph Json?
  post_video_followers       Int?

  // 2. Thời gian xem & Tỷ lệ giữ chân
  post_video_avg_time_watched Float?
  post_video_social_actions   Int?
  post_video_view_time        Float?

  // 1. Tương tác trên Video
  post_video_likes_by_reaction_type Json?

  @@index([user_id])
  @@map("mpi_bc_hieu_suat_video_tung_video")
}

// BC Hiệu suất Video (Tổng hợp)
model MPI_BcHieuSuatVideoTongHop {
  pkId String @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now())

  // 1.Lượt xem Video
  page_video_views        Int?
  page_video_views_paid   Int?
  page_video_views_organic Int?
  page_video_views_unique Int?

  // 2.Lượt xem Hoàn thành (30s)
  page_video_complete_views_30s        Int?
  page_video_complete_views_30s_unique Int?

  // 3.Thời gian xem
  page_video_view_time Float?

  @@index([user_id])
  @@map("mpi_bc_hieu_suat_video_tong_hop")
}

// BC Tổng hợp Hiệu suất Trang (Nâng cao)
model MPI_BcTongHopHieuSuatTrangNangCao {
  pkId String @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now())

  // 1.Thông tin cơ bản
  platform  String?
  page_id   String?
  page_name String? @db.Text()
  date      DateTime?

  // 2.Tăng trưởng Follower
  followers_total Int?
  follows_new     Int?
  unfollows       Int?
  net_follows     Int?

  // 3.Hiển thị & Tiếp cận (Tổng thể)
  impressions_total Int?
  reach_total       Int?
  impressions_paid  Int?
  reach_paid        Int?
  frequency         Float?
  page_views        Int?

  // 4.Hiển thị & Tiếp cận (Bài viết)
  post_impressions Int?
  post_reach       Int?

  // 5.Tương tác & Hành động
  engagements     Int?
  cta_clicks      Int?
  engagement_rate Float?

  // Video
  video_views     Int?
  video_view_time Float?

  @@index([user_id])
  @@map("mpi_bc_tong_hop_hieu_suat_trang_nang_cao")
}

// BC Hiệu suất Bài viết (Lifetime)
model MPI_BcHieuSuatBaiVietLifetime {
  pkId String @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now())

  // Chỉ số Hiệu suất
  post_impressions              Int?
  post_impressions_unique       Int?
  post_clicks                   Int?
  post_reactions_by_type_total  Json?
  post_video_views              Int?
  post_video_views_unique       Int?

  @@index([user_id])
  @@map("mpi_bc_hieu_suat_bai_viet_lifetime")
}


// -------------------------------------
// NHÓM BCA: Báo cáo BC & Account
// -------------------------------------

/// @model
/// Dữ liệu cho template "BCs Info"
model BCA_BCInfo {
  pkId      String   @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now()) 

  // Metrics
  bc_id       String?
  bc_name     String? @db.Text()
  company     String?
  currency    String?
  status      String?
  type        String?
  timezone    String?
  user_role   String?
  finance_role String?

  @@unique([user_id, bc_id])
  @@index([user_id])
  @@map("bca_bc_info")
}

/// @model
/// Dữ liệu cho template "BC & Accounts Info"
model bca_bc_account_info {
  pkId      String   @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now()) 

  // Metrics
  advertiser_id   String?
  name            String? @db.Text()
  status          String?
  currency        String?
  timezone        String?
  company         String?
  industry        String?
  country         String?
  address         String?
  contacter       String?
  email           String?
  cellphone_number String?
  owner_bc_id     String?
  create_time     DateTime?
  balance         Float?
  role            String?

  @@index([user_id])
  @@map("bca_bc_account_info")
}

/// @model
/// Dữ liệu cho template "BC Assets Info"
model BCA_BCAssetInfo {
  pkId      String   @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now()) 

  // Dimensions
  bc_id       String?
  asset_type  String?

  // Metrics
  asset_id        String?
  asset_name      String? @db.Text()
  owner_bc_name   String? @db.Text()
  relation_type   String?
  advertiser_status String?
  advertiser_role String?
  catalog_role    String?
  store_role      String?
  relation_status String?

  @@index([user_id])
  @@map("bca_bc_asset_info")
}

// -------------------------------------
// NHÓM TTA: Báo cáo hiệu suất
// -------------------------------------

/// @model
/// Dữ liệu cho template "Campaign Performance" (Ví dụ của bạn)
model TTA_CampaignPerformance {
  pkId      String   @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now()) 

  // Thông tin Định danh (Dimensions)
  stat_time_day   DateTime?
  campaign_id     String?
  start_date      DateTime?
  end_date        DateTime?
  advertiser_id   String?
  advertiser_name String? @db.Text()
  campaign_name   String? @db.Text()
  objective_type  String?

  // Số liệu (Metrics)
  spend                       Float?
  impressions                 Int?
  clicks                      Int?
  ctr                         Float?
  cpc                         Float?
  cpm                         Float?
  reach                       Int?
  frequency                   Float?
  conversion                  Int?
  cost_per_conversion         Float?
  conversion_rate             Float?
  video_play_actions          Int?
  profile_visits              Int?
  likes                       Int?
  comments                    Int?
  shares                      Int?
  follows                     Int?
  live_views                  Int?
  purchase                    Int?
  
  // Số liệu mua sắm On-site
  total_onsite_shopping_value Float?
  onsite_shopping             Int?
  onsite_shopping_roas        Float?
  cost_per_onsite_shopping    Float?

  @@unique([user_id, advertiser_id, campaign_id, objective_type, start_date, end_date, stat_time_day])
  @@index([user_id])
  @@map("tta_campaign_performance")
}

/// @model
/// Dữ liệu cho template "AdGroup Performance"
model TTA_AdGroupPerformance {
  pkId      String   @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now()) 

  // Dimensions
  stat_time_day   DateTime?
  adgroup_id      String?
  start_date      DateTime?
  end_date        DateTime?
  advertiser_id   String?
  advertiser_name String? @db.Text()

  // Metrics
  adgroup_name    String? @db.Text()
  campaign_name   String? @db.Text()
  spend           Float?
  impressions     Int?
  clicks          Int?
  ctr             Float?
  cpc             Float?
  cpm             Float?
  reach           Int?
  frequency       Float?
  conversion      Int?
  cost_per_conversion Float?
  conversion_rate Float?
  video_play_actions Int?
  purchase        Int?
  profile_visits  Int?
  likes           Int?
  comments        Int?
  shares          Int?
  follows         Int?
  live_views      Int?
  
  // On-site Shopping
  total_onsite_shopping_value Float?
  onsite_shopping             Int?
  onsite_shopping_roas        Float?
  cost_per_onsite_shopping    Float?

  @@unique([user_id, advertiser_id, adgroup_id, start_date, end_date, stat_time_day])
  @@index([user_id])
  @@map("tta_adgroup_performance")
}

/// @model
/// Dữ liệu cho template "Ad Performance"
model TTA_AdPerformance {
  pkId      String   @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now()) 

  // Dimensions
  stat_time_day   DateTime?
  ad_id           String?
  start_date      DateTime?
  end_date        DateTime?
  advertiser_id   String?
  advertiser_name String? @db.Text()
  campaign_name   String? @db.VarChar(255)
  adgroup_name     String? @db.VarChar(255)

  // Metrics
  ad_text         String? @db.Text()
  ad_name         String? @db.Text()
  spend           Float?
  impressions     Int?
  clicks          Int?
  ctr             Float?
  cpc             Float?
  cpm             Float?
  reach           Int?
  frequency       Float?
  conversion      Int?
  cost_per_conversion Float?
  conversion_rate Float?
  video_play_actions Int?
  purchase        Int?
  profile_visits  Int?
  likes           Int?
  comments        Int?
  shares          Int?
  follows         Int?
  live_views      Int?
  
  // On-site Shopping
  total_onsite_shopping_value Float?
  onsite_shopping             Int?
  onsite_shopping_roas        Float?
  cost_per_onsite_shopping    Float?

  @@unique([user_id, advertiser_id, campaign_name, adgroup_name, ad_id, start_date, end_date, stat_time_day])
  @@index([user_id])
  @@map("tta_ad_performance")

}

/// @model
/// Dữ liệu cho template "Creative Performance (Video/Image)"
model TTA_CreativePerformance {
  pkId      String   @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now()) 

  // Dimensions
  ad_id           String?
  start_date      DateTime?
  end_date        DateTime?
  advertiser_id   String?
  advertiser_name String? @db.Text()

  // Metrics
  campaign_id     String?
  campaign_name   String? @db.Text()
  adgroup_id      String?
  adgroup_name    String? @db.Text()
  ad_name         String? @db.Text()
  spend           Float?
  impressions     Int?
  clicks          Int?
  ctr             Float?
  conversion      Int?
  cost_per_conversion Float?

  @@unique([user_id, advertiser_id, campaign_id, adgroup_id, ad_id, start_date, end_date])
  @@index([user_id])
  @@map("tta_creative_performance")
}

// -------------------------------------
// NHÓM TTA: Báo cáo đối tượng & vị trí
// -------------------------------------

/// @model
/// Dữ liệu cho template "Audience Report: Region by Campaign"
model TTA_AudienceRegionReport {
  pkId      String   @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now()) 
  // Dimensions
  campaign_id     String?
  province_id     String?
  province_name   String? @db.Text()
  start_date      DateTime?
  end_date        DateTime?
  advertiser_id   String?
  advertiser_name String? @db.Text()

  // Metrics
  campaign_name   String? @db.Text()
  spend           Float?
  impressions     Int?
  clicks          Int?
  ctr             Float?
  cpc             Float?
  cpm             Float?
  reach           Int?
  conversion      Int?
  cost_per_conversion Float?
  conversion_rate Float?
  profile_visits  Int?
  likes           Int?
  comments        Int?
  shares          Int?
  follows         Int?
  
  // Video Metrics
  video_play_actions Int?
  video_watched_2s   Int?
  video_watched_6s   Int?
  video_views_p25    Int?
  video_views_p50    Int?
  video_views_p75    Int?
  video_views_p100   Int?
  average_video_play Float?

  @@unique([user_id, start_date, end_date, advertiser_id, campaign_id, province_id])
  @@index([user_id])
  @@map("tta_audience_region_report")

}

/// @model
/// Dữ liệu cho template "Audience Report: Country by Campaign"
model TTA_AudienceCountryReport {
  pkId      String   @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now()) 

  // Dimensions
  stat_time_day   DateTime?
  campaign_id     String?
  country_code    String?
  start_date      DateTime?
  end_date        DateTime?
  advertiser_id   String?
  advertiser_name String? @db.Text()

  // Metrics
  campaign_name   String? @db.Text()
  spend           Float?
  impressions     Int?
  clicks          Int?
  ctr             Float?
  cpc             Float?
  cpm             Float?
  reach           Int?
  conversion      Int?
  cost_per_conversion Float?
  conversion_rate Float?
  video_play_actions Int?
  likes           Int?
  comments        Int?
  shares          Int?
  follows         Int?
  profile_visits  Int?

  @@unique([user_id, start_date, end_date, advertiser_id, campaign_id, country_code, stat_time_day])
  @@index([user_id])
  @@map("tta_audience_country_report")
}

/// @model
/// Dữ liệu cho template "Audience Report: Age by Campaign"
model TTA_AudienceAgeReport {
  pkId      String   @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now()) 

  // Dimensions
  stat_time_day   DateTime?
  campaign_id     String?
  age             String? // e.g., "18-24"
  start_date      DateTime?
  end_date        DateTime?
  advertiser_id   String?
  advertiser_name String? @db.Text()

  // Metrics (Tương tự Country Report)
  campaign_name   String? @db.Text()
  spend           Float?
  impressions     Int?
  clicks          Int?
  ctr             Float?
  cpc             Float?
  cpm             Float?
  reach           Int?
  conversion      Int?
  cost_per_conversion Float?
  conversion_rate Float?
  video_play_actions Int?
  likes           Int?
  comments        Int?
  shares          Int?
  follows         Int?
  profile_visits  Int?

  @@unique([user_id, start_date, end_date, advertiser_id, campaign_id, age, stat_time_day])
  @@index([user_id])
  @@map("tta_audience_age_report")

}

/// @model
/// Dữ liệu cho template "Audience Report: Gender by Campaign"
model TTA_AudienceGenderReport {
  pkId      String   @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now()) 

  // Dimensions
  stat_time_day   DateTime?
  campaign_id     String?
  gender          String? // e.g., "GENDER_MALE"
  start_date      DateTime?
  end_date        DateTime?
  advertiser_id   String?
  advertiser_name String? @db.Text()

  // Metrics (Tương tự Country Report)
  campaign_name   String? @db.Text()
  spend           Float?
  impressions     Int?
  clicks          Int?
  ctr             Float?
  cpc             Float?
  cpm             Float?
  reach           Int?
  conversion      Int?
  cost_per_conversion Float?
  conversion_rate Float?
  video_play_actions Int?
  likes           Int?
  comments        Int?
  shares          Int?
  follows         Int?
  profile_visits  Int?

  @@unique([user_id, start_date, end_date, advertiser_id, campaign_id, gender, stat_time_day])
  @@index([user_id])
  @@map("tta_audience_gender_report")
}

/// @model
/// Dữ liệu cho template "Audience Report: Age & Gender by Campaign"
model TTA_AudienceAgeGenderReport {
  pkId      String   @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now()) 

  // Dimensions
  stat_time_day   DateTime?
  campaign_id     String?
  age             String?
  gender          String?
  start_date      DateTime?
  end_date        DateTime?
  advertiser_id   String?
  advertiser_name String? @db.Text()

  // Metrics (Tương tự Country Report)
  campaign_name   String? @db.Text()
  spend           Float?
  impressions     Int?
  clicks          Int?
  ctr             Float?
  cpc             Float?
  cpm             Float?
  reach           Int?
  conversion      Int?
  cost_per_conversion Float?
  conversion_rate Float?
  video_play_actions Int?
  likes           Int?
  comments        Int?
  shares          Int?
  follows         Int?
  profile_visits  Int?

  @@unique([user_id, start_date, end_date, advertiser_id, campaign_id, age, gender, stat_time_day])
  @@index([user_id])
  @@map("tta_audience_age_gender_report")

}

/// @model
/// Dữ liệu cho template "Placement Report by Campaign"
model TTA_PlacementReport {
  pkId      String   @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now()) 

  // Dimensions
  campaign_id     String?
  placement       String? // e.g., "PLACEMENT_TIKTOK"
  start_date      DateTime?
  end_date        DateTime?
  advertiser_id   String?
  advertiser_name String? @db.Text()

  // Metrics
  campaign_name   String? @db.Text()
  spend           Float?
  impressions     Int?
  clicks          Int?
  ctr             Float?
  conversion      Int?
  cost_per_conversion Float?

  @@unique([user_id, start_date, end_date, advertiser_id, campaign_id, placement])
  @@index([user_id])
  @@map("tta_placement_report")
}

/// @model
/// Dữ liệu cho template "Platform Report by Campaign"
model TTA_PlatformReport {
  pkId      String   @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now()) 

  // Dimensions
  campaign_id     String?
  platform        String? // e.g., "PLATFORM_IOS"
  start_date      DateTime?
  end_date        DateTime?
  advertiser_id   String?
  advertiser_name String? @db.Text()

  // Metrics
  campaign_name   String? @db.Text()
  spend           Float?
  impressions     Int?
  clicks          Int?
  ctr             Float?
  conversion      Int?
  cost_per_conversion Float?

  @@unique([user_id, start_date, end_date, advertiser_id, campaign_id, platform])
  @@index([user_id])
  @@map("tta_platform_report")
}

// -------------------------------------
// NHÓM GMV: Báo cáo hiệu suất
// -------------------------------------

/// @model
model GMV_AllCampaignPerformance {
  pkId      String   @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now()) 

  // Dimensions
  campaign_id     String?
  stat_time_day   DateTime?
  start_date      DateTime?
  end_date        DateTime?
  advertiser_id   String?
  advertiser_name String? @db.Text()
  store_id        String?
  store_name      String? @db.Text()
  
  // Metrics
  campaign_name   String? @db.Text()
  cost            Float?
  orders          Int?
  roi             Float?
  cost_per_order  Float?
  gross_revenue   Float?
  net_cost        Float?
  roas_bid        Float?
  operation_status String?
  schedule_type   String?
  schedule_start_time DateTime?
  schedule_end_time   DateTime?
  target_roi_budget   Float?
  bid_type        String?
  max_delivery_budget Float?

  @@unique([user_id, advertiser_id, store_id, campaign_id, start_date, end_date, stat_time_day])
  @@index([user_id])
  @@map("gmv_all_campaign_performance")
}

model GMV_LiveCampaignPerformance {
  pkId      String   @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now()) 

  // Dimensions
  campaign_id     String?
  stat_time_day   DateTime?
  start_date      DateTime?
  end_date        DateTime?
  advertiser_id   String?
  advertiser_name String? @db.Text()
  store_id        String?
  store_name      String? @db.Text()
  
  // Metrics
  campaign_name   String? @db.Text()
  cost            Float?
  orders          Int?
  roi             Float?
  cost_per_order  Float?
  gross_revenue   Float?
  net_cost        Float?
  roas_bid        Float?
  operation_status String?
  schedule_type   String?
  schedule_start_time DateTime?
  schedule_end_time   DateTime?
  target_roi_budget   Float?
  bid_type        String?
  max_delivery_budget Float?

  @@unique([user_id, advertiser_id, store_id, campaign_id, start_date, end_date, stat_time_day])
  @@index([user_id])
  @@map("gmv_live_campaign_performance")
}

model GMV_ProductCampaignPerformance {
  pkId      String   @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now()) 

  // Dimensions
  campaign_id     String?
  stat_time_day   DateTime?
  start_date      DateTime?
  end_date        DateTime?
  advertiser_id   String?
  advertiser_name String? @db.Text()
  store_id        String?
  store_name      String? @db.Text()
  
  // Metrics
  campaign_name   String? @db.Text()
  cost            Float?
  orders          Int?
  roi             Float?
  cost_per_order  Float?
  gross_revenue   Float?
  net_cost        Float?
  roas_bid        Float?
  operation_status String?
  schedule_type   String?
  schedule_start_time DateTime?
  schedule_end_time   DateTime?
  target_roi_budget   Float?
  bid_type        String?
  max_delivery_budget Float?

  @@unique([user_id, advertiser_id, store_id, campaign_id, start_date, end_date, stat_time_day])
  @@index([user_id])
  @@map("gmv_product_campaign_performance")
}

/// Dữ liệu cho template "GMV Campaign / Product Detail"
model GMV_ProductDetailReport {
  pkId      String   @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now()) 

  // Dimensions
  stat_time_day   DateTime?
  campaign_id     String?
  item_group_id   String?
  product_img     String? @db.Text()
  start_date      DateTime?
  end_date        DateTime?
  advertiser_id   String?
  advertiser_name String? @db.Text() 
  store_id        String?
  store_name      String? @db.Text()
  
  // Metrics
  campaign_name     String? @db.Text()
  operation_status  String?
  bid_type          String?
  product_name      String? @db.Text()
  product_image_url String? @db.Text()
  orders            Int?
  gross_revenue     Float?
  cost              Float?
  cost_per_order    Float?
  roi               Float?
  currency          String?
  product_status    String?

  @@unique([user_id, advertiser_id, store_id, campaign_id, start_date, end_date, stat_time_day, item_group_id])
  @@index([user_id])
  @@map("gmv_product_detail_report")
}

/// @model
/// Dữ liệu cho template "GMV Campaign / Creative Detail"
model GMV_CreativeDetailReport {
  pkId      String   @id @default(uuid())
  user_id  String
  createdAt DateTime @default(now()) @map("created_at")

  // Dimensions
  campaign_id     String?
  item_group_id   String?
  item_id         String? // Creative ID
  product_img     String? @db.Text() 
  start_date      DateTime?
  end_date        DateTime?
  advertiser_id   String?
  advertiser_name String? @db.Text()
  store_id        String?
  store_name      String? @db.Text()

  // Metrics - Thuộc tính
  campaign_name   String? @db.Text()
  operation_status String?
  product_name    String? @db.Text()
  product_status  String?
  product_image_url String? @db.Text()
  creative_delivery_status String?
  title           String? @db.Text()
  tt_account_name String? @db.Text()
  tt_account_profile_image_url String? @db.Text()

  // Metrics - Hiệu suất chính
  cost            Float?
  orders          Int?
  cost_per_order  Float?
  gross_revenue   Float?
  roi             Float?
  currency        String?

  // Metrics - Chỉ số sản phẩm
  product_impressions Int?
  product_clicks      Int?
  product_click_rate  Float?

  // Metrics - Chỉ số quảng cáo
  ad_conversion_rate Float?

  // Metrics - Tỷ lệ xem video
  ad_video_view_rate_2s   Float?
  ad_video_view_rate_6s   Float?
  ad_video_view_rate_p25  Float?
  ad_video_view_rate_p50  Float?
  ad_video_view_rate_p75  Float?
  ad_video_view_rate_p100 Float?

  @@unique([user_id, advertiser_id, store_id, campaign_id, start_date, end_date, item_group_id, item_id])
  @@index([user_id])
  @@map("gmv_creative_detail_report")
}

model User {
  id        String  @id @default(cuid())
  username  String  @unique 
  email     String? @unique 
  password  String  
  
  settings  Json?   @default("{}") 

  passwordResetToken PasswordResetToken[]

  refreshTokens RefreshToken[] 

  taskSchedules TaskSchedule[] // một user có thể có nhiều taskSchedules
  
  @@index([id])
  @@map("user")
}

model RefreshToken {
  id        String   @id @default(cuid())
  hashedToken String   @unique 
  userId    String
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade) // Xóa token khi user bị xóa
  expiresAt DateTime
  createdAt DateTime @default(now())

  @@index([userId])
  @@map("refresh_token")
}

model TaskLog {
  id        String   @id @default(cuid())
  taskId    String  
  userId    String   
  level     String
  message   String    @db.Text()
  timestamp DateTime @default(now())

  @@index([taskId])
  @@index([userId]) 
  @@map("task_log")
}

model POS_BasicReport {
  // --- Metadata (Bắt buộc) ---
  pkId      String   @id @default(uuid())
  user_id   String
  task_id   String?
  createdAt DateTime @default(now()) 

  // --- 01. Thông tin Định danh & Hệ thống ---
  is_primary_row  Boolean?
  order_id        String?   
  display_id      String?
  system_id       String?
  shop_id         String?
  conversation_id String?
  order_link      String?
  tracking_link   String?

  // --- 02. Thời gian & Trạng thái ---
  created_at          DateTime? 
  created_date        String?   
  updated_at          DateTime?
  status_code         Int?      
  status_name         String?
  sub_status          String?
  is_locked           Boolean?
  is_received_at_shop Boolean?

  // --- 03. Nguồn & Marketing ---
  source_name   String?
  source_id     String?
  ads_source    String?
  ad_id         String?
  page_id       String?
  page_name     String?
  page_username String?
  post_id       String?
  marketer_id   String?
  utm_source    String?
  utm_medium    String?
  utm_campaign  String?
  utm_content   String?
  utm_term      String?

  // --- 04. Nhân sự (Người dùng) ---
  creator_id         String?
  creator_name       String?
  seller_name        String?
  seller_id          String?
  seller_assigned_at DateTime? 
  care_staff_name    String?
  care_staff_id      String?
  care_assigned_at   DateTime? 
  last_editor_name   String?

  // --- 05. Khách hàng & Địa chỉ ---
  customer_system_id String? // (customer.id)
  customer_uuid      String? // (customer.customer_id)
  customer_name      String?
  customer_phone     String?
  customer_email     String?
  customer_gender    String?
  full_address       String?
  street_address     String?
  ward_name          String?
  district_name      String?
  province_name      String?
  postal_code        String?

  // --- 06. Tài chính (Tổng quan) ---
  currency                    String?
  total_amount                Float?
  total_after_sub_discount    Float?
  total_discount              Float?
  amount_to_collect           Float?
  cod_amount                  Float?
  carrier_cod_amount          Float?
  tax_amount                  Float?
  surcharge_amount            Float?
  surcharge_cost              Float?
  shipping_fee_customer       Float?
  shipping_fee_carrier        Float?
  marketplace_fee             Float?
  is_customer_paying_shipping Boolean?
  is_free_shipping            Boolean?

  // --- 07. Thanh toán ---
  payment_methods String? 
  payment_cash    Float?
  payment_transfer Float?
  payment_card    Float?
  payment_momo    Float?
  payment_vnpay   Float?
  payment_qrpay   Float?
  payment_kredivo Float?
  payment_fundiin Float?
  payment_prepaid Float?
  payment_points  Float?
  exchange_value  Float?

  // --- 08. Vận chuyển & Kho ---
  carrier_name       String?
  tracking_code      String?
  sent_to_carrier_at DateTime? 
  shipping_service   String?
  warehouse_id       String?
  warehouse_name     String?
  warehouse_address  String?

  // --- 09. Chi tiết Sản phẩm (Item) ---
  order_total_quantity Int?
  order_item_count     Int?
  
  // (Level Item)
  item_id            String?
  product_code       String?
  sku_code           String?
  product_name       String?
  item_quantity      Float?    
  item_retail_price  Float?
  item_cost_price    Float?
  item_discount      Float?
  item_price_final   Float?
  item_total_amount  Float?
  item_weight        Float?
  item_note          String?
  is_bonus_item      Boolean?
  is_wholesale_item  Boolean?

  // --- 10. Khác ---
  internal_note      String? @db.Text()
  printed_note       String? @db.Text()
  tags               String?
  is_livestream      Boolean?
  is_live_shopping   Boolean?
  is_social_commerce Boolean?
  is_exchange_order  Boolean?
  return_reason_id   String?
  return_reason_name String?

  // --- Index ---
  @@index([user_id])
  @@unique([user_id, order_id, item_id])
  @@map("pos_basic_report")
}

model TaskSchedule {
  id             String   @id @default(cuid())
  userId         String
  name           String   
  
  taskData       Json     
  
  // Cấu hình Cron
  cronExpression String   // "0 8 * * *"
  timezone       String   @default("Asia/Ho_Chi_Minh")
  isActive       Boolean  @default(true)
  
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  user           User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  executions     TaskMetric[] 

  @@index([userId])
  @@map("task_schedule")
}

model TaskMetric {
  id          String   @id @default(cuid())
  taskId      String   @unique 
  userId      String
  taskType    String  
  status      String   
  
  durationMs  Int      @default(0) 
  rowsWritten Int      @default(0) 
  apiCalls    Int      @default(0) 
  
  createdAt   DateTime @default(now()) 

  scheduleId  String?
  schedule    TaskSchedule? @relation(fields: [scheduleId], references: [id])

  @@index([userId])
  @@index([scheduleId]) 
  @@index([createdAt]) 
  @@map("task_metric")
}

model PasswordResetToken {
  id        String   @id @default(uuid())
  token     String   @unique // Token gửi qua email
  expiresAt DateTime // Thời gian hết hạn
  userId    String
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  createdAt DateTime @default(now())

  @@index([userId])
  @@map("password_reset_token")
}